define(["jquery","typeahead","underscore","lib/json2"],function(e){return function(t){var n=this,r=[];e("#SKUInput").typeahead({items:5,source:function(t,n){if(typeof r=="object"&&r.length<=0)e.getJSON("/Product/get-products-json",{query:t},function(e){r=e;var t=_.map(r,function(e){return e.sku});n(t)});else{var i=_.map(r,function(e){return e.sku});n(i)}},highlighter:function(e){var t=_.find(r,function(t){return t.sku==e});return'<img class="pull-left" style="margin-top: 4px;margin-right: 10px;" src="'+xsaleConfig.thumbnailPath+(t.picture?t.picture:"default.jpg")+'" alt="" width="40px" height="40px">'+'<div class="pull-left">'+"<div>"+t.sku+" (库存:"+t.stock+")</div>"+'<div style="color:#cccccc">'+t.name+"</div>"+"</div>"+'<div class="clearfix"></div>'},updater:function(e){return t(e,r)}}),n.resetSource=function(){r=[]}}});