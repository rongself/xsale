define(["knockout","validation","underscore"],function(e){e.validation.rules.pattern.message="Invalid.",e.validation.configure({registerExtenders:!0,messagesOnModified:!0,insertMessages:!0,parseInputAttributes:!1,messageTemplate:null}),e.bindingHandlers.bootstrapSwitch={init:function(t,n,r){$(t).bootstrapSwitch(),$(t).bootstrapSwitch("state",n()()),$(t).on("switchChange.bootstrapSwitch",function(e,t){var r=n();r(t)});var i=r().bootstrapSwitchOptions||{};for(var s in i)$(t).bootstrapSwitch(s,e.utils.unwrapObservable(i[s]));e.utils.domNodeDisposal.addDisposeCallback(t,function(){$(t).bootstrapSwitch("destroy")})},update:function(t,n,r){var i=e.utils.unwrapObservable(n()),s=r().bootstrapSwitchOptions||{};for(var o in s)$(t).bootstrapSwitch(o,e.utils.unwrapObservable(s[o]));$(t).bootstrapSwitch("state",i)}};var t=function(e,t){$.ajax({context:document.body,url:"/Product/ajax-is-product-exists",type:"POST",data:{sku:e},dataType:"json"}).done(function(e,n,r){e.result==1?t(!0):t(!1)}).fail(function(e,n,r){t(!1)})};e.validation.rules.isProductExists={async:!0,message:"该产品不存在于库存中,也许你需要先进货:)",validator:function(e,n,r){t(e,r)}},uniqueInObservableArray=function(t,n){var r=e.utils.arrayFirst(n,function(e){return console.log(e.sku()+"==="+t),e.sku()===t});return r===null},e.validation.rules.isPhoneNumberExists={async:!0,message:"该手机号已存在",validator:function(e,t,n){$.ajax({url:"/customer/ajax-is-phoneNumber-exists",type:"POST",data:{phoneNumber:e},dataType:"json"}).done(function(e,t,r){e.result==1?n(!1):n(!0)}).fail(function(e,t,r){n(!1)})}},e.validation.rules.isUsernameExists={async:!0,message:"该登录名已存在",validator:function(e,t,n){$.ajax({url:"/account/ajax-is-username-exists",type:"POST",data:{account:e},dataType:"json"}).done(function(e,t,r){e.result==1?n(!1):n(!0)}).fail(function(e,t,r){n(!1)})}},e.validation.rules.areSame={getValue:function(e){return typeof e=="function"?e():e},validator:function(e,t){return e===this.getValue(t)},message:"两次输入的密码不相同"},e.validation.registerExtenders()});