require(["jquery","knockout","viewmodel/statistics","datetimepicker","chart","underscore"],function(e,t,n,r,i,s){function l(t,n){e.getJSON("/statistics/ajax-get-total-profit-weekly",{startDate:t,endDate:n},function(e){var t=s.max(e.priceData,function(e){return e[0]})[0],n=s.min(e.priceData,function(e){return e[0]})[0];u.profitData=e.profitData,u.priceData=e.priceData;var r=new i({data:[{data:u.profitData,label:"利润"},{data:u.priceData,label:"销售额"}]});r.apply(),o.profitSum(e.sum.totalProfit),o.priceSum(e.sum.totalPriceAmount),o.startTime(p(n)),o.endTime(p(t)),o.list(e.profitList)})}function c(e,t,n){var r=864e5;for(var i=n;i<t;i+=r)s.find(e,function(e){return e[0]==i})==null&&e.push([i,0]);return s.sortBy(e,function(e){return e[0]})}function h(e,t,n){var r=6048e5;n=getLastDayOfThisWeek(n),t=getLastDayOfThisWeek(t);for(var i=n;i<t;i+=r)s.find(e,function(e){return e[0]==i})==null&&e.push([i,0]);return s.sortBy(e,function(e){return e[0]})}function p(e){var t=new Date(parseInt(e)),n=t.getMonth()+1,r=t.getDate(),i=t.getFullYear();return i+"/"+n+"/"+r}e("#startTime").datetimepicker({pickTime:!1,language:"zh-CN"}),e("#endTime").datetimepicker({pickTime:!1,language:"zh-CN"});var o=new n,u=[],a=moment().add(-30,"days").format("YYYY-MM-DD"),f=moment().format("YYYY-MM-DD");e("#startTime input").val(a),e("#endTime input").val(f),e("#flushData").click(function(){var t=e("#startTime input").val(),n=e("#endTime input").val();l(t,n)}),l(a,f),t.applyBindings(o,e("#profitList").get(0))});