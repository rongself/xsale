define(["knockout","viewmodel/abstract","viewmodel/stockRecord","viewmodel/stockProduct","knockoutMapping","formPost","message","cookie"],function(e,t,n,r,i,s,o){return function(){t.call(this),n.call(this);var u=this;u.id=e.observable(""),u.ajaxInit=function(){$.getJSON("/stock-record/ajax-get-record",{id:u.id()},function(t){u.stockTime(moment(t.stockTime).format("YYYY-MM-DD"));var n=t.stockItems;for(var i in n){var s=new r(u);s.itemId=e.observable(),s.itemId(n[i].id),s.sku(n[i].product.sku),s.name(n[i].product.name),s.cost(n[i].product.cost),s.stock(n[i].quantity),s.price(n[i].product.price),s.description(n[i].product.description);var o=n[i].product.productImages;for(var a in o)s.pictures.push(o[a].url);u.stockProducts.push(s)}})},u.submitAndContinue=function(e){if(!(u!=null&&typeof u.stockProducts()=="object"&&u.stockProducts().length>0))return o.warning("进货单中还未加入任何产品"),!1;var t=i.toJSON(u);s.submit({viewModel:u,url:"/stock-record/edit-record",data:{stockRecord:t},success:function(){o.success("进货单已成功提交"),typeof e=="function"&&e()}})},u.setDefaultValue(),u.ajaxInit()}});